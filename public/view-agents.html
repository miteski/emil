function fetchAgents(page, search = '') {
    fetch(`/api/agents?page=${page}&pageSize=${pageSize}&search=${search}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('Agents data received:', data);
            const tableBody = document.getElementById('agentsTableBody');
            tableBody.innerHTML = '';
            if (data.agents && data.agents.length > 0) {
                data.agents.forEach(agent => {
                    const row = `<tr>
                        <td>${agent.Fullname}</td>
                        <td>${agent.Email}</td>
                        <td>${agent.TenantName}</td>
                    </tr>`;
                    tableBody.innerHTML += row;
                });
            } else {
                tableBody.innerHTML = '<tr><td colspan="3">No agents found</td></tr>';
            }
            document.getElementById('currentPage').textContent = page;
        })
        .catch(error => {
            console.error('Error fetching agents:', error);
            document.getElementById('agentsTableBody').innerHTML = `<tr><td colspan="3">Error fetching agents: ${error.message}</td></tr>`;
        });
}
